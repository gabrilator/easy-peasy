{"version":3,"file":"easy-peasy.esm.js","sources":["../src/context.js","../src/hooks.js","../src/constants.js","../src/helpers.js","../src/lib.js","../src/create-reducer.js","../src/persistence.js","../src/actions.js","../src/thunks.js","../src/listeners.js","../src/computed-properties.js","../src/extract-data-from-model.js","../src/create-store-internals.js","../src/create-store.js","../src/create-context-store.js","../src/create-component-store.js","../src/create-transform.js","../src/provider.js","../src/index.js"],"sourcesContent":["import { createContext } from 'react';\r\n\r\nconst StoreContext = createContext();\r\n\r\nexport default StoreContext;\r\n","import {\r\n  useContext,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useReducer,\r\n  useRef,\r\n  useState,\r\n} from 'react';\r\nimport EasyPeasyContext from './context';\r\n\r\n// React currently throws a warning when using useLayoutEffect on the server.\r\n// To get around it, we can conditionally useEffect on the server (no-op) and\r\n// useLayoutEffect in the browser. We need useLayoutEffect to ensure the store\r\n// subscription callback always has the selector from the latest render commit\r\n// available, otherwise a store update may happen between render and the effect,\r\n// which may cause missed updates; we also must ensure the store subscription\r\n// is created synchronously, otherwise a store update may occur before the\r\n// subscription is created and an inconsistent state may be observed\r\nconst useIsomorphicLayoutEffect =\r\n  typeof window !== 'undefined' ? useLayoutEffect : useEffect;\r\n\r\nexport function createStoreStateHook(Context) {\r\n  return function useStoreState(mapState) {\r\n    const store = useContext(Context);\r\n    const mapStateRef = useRef(mapState);\r\n    const stateRef = useRef();\r\n    const mountedRef = useRef(true);\r\n    const subscriptionMapStateError = useRef();\r\n\r\n    const [, forceRender] = useReducer(s => s + 1, 0);\r\n\r\n    if (\r\n      subscriptionMapStateError.current ||\r\n      mapStateRef.current !== mapState ||\r\n      stateRef.current === undefined\r\n    ) {\r\n      try {\r\n        stateRef.current = mapState(store.getState());\r\n      } catch (err) {\r\n        if (process.env.NODE_ENV === 'development') {\r\n          let errorMessage = `An error occurred trying to map state in a useStoreState hook: ${err.message}.`;\r\n          if (subscriptionMapStateError.current) {\r\n            errorMessage += `\\nThis error may be related to the following error:\\n${subscriptionMapStateError.current.stack}\\n\\nOriginal stack trace:`;\r\n          }\r\n          throw new Error(errorMessage);\r\n        }\r\n        throw subscriptionMapStateError.current || err;\r\n      }\r\n    }\r\n\r\n    useIsomorphicLayoutEffect(() => {\r\n      mapStateRef.current = mapState;\r\n      subscriptionMapStateError.current = undefined;\r\n    });\r\n\r\n    useIsomorphicLayoutEffect(() => {\r\n      const checkMapState = () => {\r\n        try {\r\n          const newState = mapStateRef.current(store.getState());\r\n          if (newState === stateRef.current) {\r\n            return;\r\n          }\r\n          stateRef.current = newState;\r\n        } catch (err) {\r\n          // see https://github.com/reduxjs/react-redux/issues/1179\r\n          // There is a possibility mapState will fail due to stale state or\r\n          // props, therefore we will just track the error and force our\r\n          // component to update. It should then receive the updated state\r\n          subscriptionMapStateError.current = err;\r\n        }\r\n        if (mountedRef.current) {\r\n          forceRender({});\r\n        }\r\n      };\r\n      const unsubscribe = store.subscribe(checkMapState);\r\n      checkMapState();\r\n      return () => {\r\n        mountedRef.current = false;\r\n        unsubscribe();\r\n      };\r\n    }, []);\r\n\r\n    return stateRef.current;\r\n  };\r\n}\r\n\r\nexport const useStoreState = createStoreStateHook(EasyPeasyContext);\r\n\r\nexport function createStoreActionsHook(Context) {\r\n  return function useStoreActions(mapActions) {\r\n    const store = useContext(Context);\r\n    return mapActions(store.getActions());\r\n  };\r\n}\r\n\r\nexport const useStoreActions = createStoreActionsHook(EasyPeasyContext);\r\n\r\nexport function createStoreDispatchHook(Context) {\r\n  return function useStoreDispatch() {\r\n    const store = useContext(Context);\r\n    return store.dispatch;\r\n  };\r\n}\r\n\r\nexport const useStoreDispatch = createStoreDispatchHook(EasyPeasyContext);\r\n\r\nexport function useStore() {\r\n  return useContext(EasyPeasyContext);\r\n}\r\n\r\nexport function createStoreRehydratedHook(Context) {\r\n  return function useStoreRehydrated() {\r\n    const store = useContext(Context);\r\n    const [rehydrated, setRehydrated] = useState(false);\r\n    useEffect(() => {\r\n      store.persist.resolveRehydration().then(() => setRehydrated(true));\r\n    }, []);\r\n    return rehydrated;\r\n  };\r\n}\r\n\r\nexport const useStoreRehydrated = createStoreRehydratedHook(EasyPeasyContext);\r\n\r\nexport function createTypedHooks() {\r\n  return {\r\n    useStoreActions,\r\n    useStoreDispatch,\r\n    useStoreState,\r\n    useStoreRehydrated,\r\n    useStore,\r\n  };\r\n}\r\n","export const actionSymbol = 'a';\r\nexport const actionOnSymbol = 'aO';\r\nexport const computedSymbol = 'c';\r\nexport const persistSymbol = 'p';\r\nexport const reducerSymbol = 'r';\r\nexport const thunkOnSymbol = 'tO';\r\nexport const thunkSymbol = 't';\r\n","import { isDraft, original } from 'immer-peasy';\r\nimport memoizerific from 'memoizerific';\r\nimport {\r\n  actionOnSymbol,\r\n  actionSymbol,\r\n  computedSymbol,\r\n  persistSymbol,\r\n  reducerSymbol,\r\n  thunkOnSymbol,\r\n  thunkSymbol,\r\n} from './constants';\r\n\r\nexport const debug = state => {\r\n  if (isDraft(state)) {\r\n    return original(state);\r\n  }\r\n  return state;\r\n};\r\n\r\nexport const memo = (fn, cacheSize) => memoizerific(cacheSize)(fn);\r\n\r\nexport const actionOn = (targetResolver, fn) => {\r\n  fn[actionOnSymbol] = {\r\n    targetResolver,\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport const action = fn => {\r\n  fn[actionSymbol] = {};\r\n  return fn;\r\n};\r\n\r\nconst defaultStateResolvers = [state => state];\r\n\r\nexport const computed = (fnOrStateResolvers, fn) => {\r\n  if (typeof fn === 'function') {\r\n    fn[computedSymbol] = {\r\n      stateResolvers: fnOrStateResolvers,\r\n    };\r\n    return fn;\r\n  }\r\n  fnOrStateResolvers[computedSymbol] = {\r\n    stateResolvers: defaultStateResolvers,\r\n  };\r\n  return fnOrStateResolvers;\r\n};\r\n\r\nexport const persist = (model, config) => {\r\n  // return {\r\n  //   ...model,\r\n  //   [persistSymbol]: config,\r\n  // };\r\n  return typeof window === 'undefined' ? model : {\r\n    ...model,\r\n    [persistSymbol]: config,\r\n  };\r\n};\r\n\r\nexport const thunkOn = (targetResolver, fn) => {\r\n  fn[thunkOnSymbol] = {\r\n    targetResolver,\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport const thunk = fn => {\r\n  fn[thunkSymbol] = {};\r\n  return fn;\r\n};\r\n\r\nexport const reducer = fn => {\r\n  fn[reducerSymbol] = {};\r\n  return fn;\r\n};\r\n","import isPlainObject from 'is-plain-object';\r\nimport { createDraft, finishDraft, isDraft } from 'immer-peasy';\r\n\r\nexport const deepCloneStateWithoutComputed = source => {\r\n  const recursiveClone = current => {\r\n    const next = Object.keys(current).reduce((acc, key) => {\r\n      if (Object.getOwnPropertyDescriptor(current, key).get == null) {\r\n        acc[key] = current[key];\r\n      }\r\n      return acc;\r\n    }, {});\r\n    Object.keys(next).forEach(key => {\r\n      if (isPlainObject(next[key])) {\r\n        next[key] = recursiveClone(next[key]);\r\n      }\r\n    });\r\n    return next;\r\n  };\r\n  return recursiveClone(source);\r\n};\r\n\r\nexport const isPromise = x => {\r\n  return x != null && typeof x === 'object' && typeof x.then === 'function';\r\n};\r\n\r\nexport function get(path, target) {\r\n  return path.reduce((acc, cur) => {\r\n    return isPlainObject(acc) ? acc[cur] : undefined;\r\n  }, target);\r\n}\r\n\r\nexport function newify(currentPath, currentState, finalValue) {\r\n  if (currentPath.length === 0) {\r\n    return finalValue;\r\n  }\r\n  const newState = { ...currentState };\r\n  const key = currentPath[0];\r\n  if (currentPath.length === 1) {\r\n    newState[key] = finalValue;\r\n  } else {\r\n    newState[key] = newify(currentPath.slice(1), newState[key], finalValue);\r\n  }\r\n  return newState;\r\n}\r\n\r\nexport const set = (path, target, value) => {\r\n  if (path.length === 0) {\r\n    if (typeof value === 'object') {\r\n      Object.keys(target).forEach(key => {\r\n        delete target[key];\r\n      });\r\n      Object.keys(value).forEach(key => {\r\n        target[key] = value[key];\r\n      });\r\n    }\r\n    return;\r\n  }\r\n  path.reduce((acc, cur, idx) => {\r\n    if (idx + 1 === path.length) {\r\n      acc[cur] = value;\r\n    } else {\r\n      acc[cur] = acc[cur] || {};\r\n    }\r\n    return acc[cur];\r\n  }, target);\r\n};\r\n\r\nexport function createSimpleProduce(disableImmer = false) {\r\n  return function simpleProduce(path, state, fn) {\r\n    if (disableImmer) {\r\n      const current = get(path, state);\r\n      const next = fn(current);\r\n      if (current !== next) {\r\n        return newify(path, state, next);\r\n      }\r\n      return state;\r\n    }\r\n    if (path.length === 0) {\r\n      const draft = createDraft(state);\r\n      const result = fn(draft);\r\n      if (result) {\r\n        return isDraft(result) ? finishDraft(result) : result;\r\n      }\r\n      return finishDraft(draft);\r\n    }\r\n    const parentPath = path.slice(0, path.length - 1);\r\n    const draft = createDraft(state);\r\n    const parent = get(parentPath, state);\r\n    const current = get(path, draft);\r\n    const result = fn(current);\r\n\r\n    if (result) {\r\n      parent[path[path.length - 1]] = result;\r\n    }\r\n    return finishDraft(draft);\r\n  };\r\n}\r\n","import { createSimpleProduce, get } from './lib';\r\nimport { actionSymbol, actionOnSymbol } from './constants';\r\n\r\nexport default function createReducer(\r\n  disableImmer,\r\n  actionReducersDict,\r\n  customReducers,\r\n  computedProperties,\r\n) {\r\n  const simpleProduce = createSimpleProduce(disableImmer);\r\n\r\n  const runActionReducerAtPath = (state, action, actionReducer, path) => {\r\n    return simpleProduce(path, state, draft =>\r\n      actionReducer(draft, action.payload),\r\n    );\r\n  };\r\n\r\n  const reducerForActions = (state, action) => {\r\n    const actionReducer = actionReducersDict[action.type];\r\n    if (actionReducer) {\r\n      const actionMeta =\r\n        actionReducer[actionSymbol] || actionReducer[actionOnSymbol];\r\n      return runActionReducerAtPath(\r\n        state,\r\n        action,\r\n        actionReducer,\r\n        actionMeta.parent,\r\n      );\r\n    }\r\n    return state;\r\n  };\r\n\r\n  const reducerForCustomReducers = (state, action) => {\r\n    return customReducers.reduce((acc, { parentPath, key, reducer: red }) => {\r\n      return simpleProduce(parentPath, acc, draft => {\r\n        draft[key] = red(draft[key], action);\r\n        return draft;\r\n      });\r\n    }, state);\r\n  };\r\n\r\n  const rootReducer = (state, action) => {\r\n    const stateAfterActions = reducerForActions(state, action);\r\n    const next =\r\n      customReducers.length > 0\r\n        ? reducerForCustomReducers(stateAfterActions, action)\r\n        : stateAfterActions;\r\n    if (state !== next) {\r\n      computedProperties.forEach(({ parentPath, bindComputedProperty }) => {\r\n        bindComputedProperty(get(parentPath, next));\r\n      });\r\n    }\r\n    return next;\r\n  };\r\n\r\n  return rootReducer;\r\n}\r\n","import debounce from 'debounce';\r\nimport isPlainObject from 'is-plain-object';\r\nimport { deepCloneStateWithoutComputed, get, isPromise, set } from './lib';\r\n\r\nconst noopStorage = {\r\n  getItem: () => undefined,\r\n  setItem: () => undefined,\r\n  removeItem: () => undefined,\r\n};\r\n\r\nconst localStorage =\r\n  typeof window !== 'undefined' && typeof window.localStorage !== 'undefined'\r\n    ? window.localStorage\r\n    : noopStorage;\r\n\r\nconst sessionStorage =\r\n  typeof window !== 'undefined' && typeof window.sessionStorage !== 'undefined'\r\n    ? window.sessionStorage\r\n    : noopStorage;\r\n\r\nfunction createStorageWrapper(storage = sessionStorage, transformers = []) {\r\n  if (typeof storage === 'string') {\r\n    if (storage === 'localStorage') {\r\n      storage = localStorage;\r\n    } else if (storage === 'sessionStorage') {\r\n      storage = sessionStorage;\r\n    } else {\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.warn(\r\n          `Invalid storage provider specified for Easy Peasy persist: ${storage}\\nValid values include \"localStorage\", \"sessionStorage\" or a custom storage engine.`,\r\n        );\r\n      }\r\n      storage = noopStorage;\r\n    }\r\n  }\r\n\r\n  const outTransformers = transformers.reverse();\r\n\r\n  const serialize = (data, key) => {\r\n    const simpleKey = key.substr(key.indexOf('@') + 1);\r\n    const transformed = transformers.reduce((acc, cur) => {\r\n      return cur.in(acc, simpleKey);\r\n    }, data);\r\n    return storage === localStorage || storage === sessionStorage\r\n      ? JSON.stringify({ data: transformed })\r\n      : transformed;\r\n  };\r\n  const deserialize = (data, key) => {\r\n    const simpleKey = key.substr(key.indexOf('@') + 1);\r\n    const result =\r\n      storage === localStorage || storage === sessionStorage\r\n        ? JSON.parse(data).data\r\n        : data;\r\n    return outTransformers.reduce((acc, cur) => {\r\n      return cur.out(acc, simpleKey);\r\n    }, result);\r\n  };\r\n\r\n  const isAsync = isPromise(storage.getItem('_'));\r\n\r\n  return {\r\n    isAsync,\r\n    getItem: key => {\r\n      if (isAsync) {\r\n        return storage.getItem(key).then(wrapped => {\r\n          return wrapped != null ? deserialize(wrapped, key) : undefined;\r\n        });\r\n      }\r\n      const wrapped = storage.getItem(key);\r\n      return wrapped != null ? deserialize(wrapped, key) : undefined;\r\n    },\r\n    setItem: (key, data) => {\r\n      return storage.setItem(key, serialize(data, key));\r\n    },\r\n    removeItem: key => {\r\n      return storage.removeItem(key);\r\n    },\r\n  };\r\n}\r\n\r\nexport function extractPersistConfig(path, persistDefinition = {}) {\r\n  return {\r\n    path,\r\n    config: {\r\n      blacklist: persistDefinition.blacklist || [],\r\n      mergeStrategy: persistDefinition.mergeStrategy || 'merge',\r\n      storage: createStorageWrapper(\r\n        persistDefinition.storage,\r\n        persistDefinition.transformers,\r\n      ),\r\n      whitelist: persistDefinition.whitelist || [],\r\n    },\r\n  };\r\n}\r\n\r\nfunction resolvePersistTargets(target, whitelist, blacklist) {\r\n  let targets = Object.keys(target);\r\n  if (whitelist.length > 0) {\r\n    targets = targets.reduce((acc, cur) => {\r\n      if (whitelist.findIndex(x => x === cur) !== -1) {\r\n        return [...acc, cur];\r\n      }\r\n      return acc;\r\n    }, []);\r\n  }\r\n  if (blacklist.length > 0) {\r\n    targets = targets.reduce((acc, cur) => {\r\n      if (blacklist.findIndex(x => x === cur) !== -1) {\r\n        return acc;\r\n      }\r\n      return [...acc, cur];\r\n    }, []);\r\n  }\r\n  return targets;\r\n}\r\n\r\nexport function createPersistor(persistKey, references) {\r\n  return debounce(() => {\r\n    references.internals.persistenceConfig.forEach(({ path, config }) => {\r\n      const { storage, whitelist, blacklist } = config;\r\n      const state = references.getState();\r\n      const persistRoot = deepCloneStateWithoutComputed(get(path, state));\r\n      const targets = resolvePersistTargets(persistRoot, whitelist, blacklist);\r\n      targets.forEach(key => {\r\n        const targetPath = [...path, key];\r\n        storage.setItem(persistKey(targetPath), get(targetPath, state));\r\n      });\r\n    });\r\n  }, 1000);\r\n}\r\n\r\nexport function createPersistMiddleware(persistor, references) {\r\n  return () => next => action => {\r\n    const state = next(action);\r\n    if (\r\n      action &&\r\n      action.type !== '@action.ePRS' &&\r\n      references.internals.persistenceConfig.length > 0\r\n    ) {\r\n      persistor(state);\r\n    }\r\n    return state;\r\n  };\r\n}\r\n\r\nexport function createPersistenceClearer(persistKey, references) {\r\n  return () =>\r\n    new Promise((resolve, reject) => {\r\n      references.internals.persistenceConfig.forEach(({ path, config }) => {\r\n        const { storage, whitelist, blacklist } = config;\r\n        const persistRoot = get(path, references.getState());\r\n        const targets = resolvePersistTargets(\r\n          persistRoot,\r\n          whitelist,\r\n          blacklist,\r\n        );\r\n        if (targets.length > 0) {\r\n          Promise.all(\r\n            targets.map(key => {\r\n              const targetPath = [...path, key];\r\n              return storage.removeItem(persistKey(targetPath));\r\n            }),\r\n          ).then(() => resolve(), reject);\r\n        } else {\r\n          resolve();\r\n        }\r\n      });\r\n    });\r\n}\r\n\r\nexport function rehydrateStateFromPersistIfNeeded(\r\n  persistKey,\r\n  replaceState,\r\n  references,\r\n) {\r\n  // If we have any persist configs we will attemp to perform a state rehydration\r\n  let resolveRehydration = Promise.resolve();\r\n  if (references.internals.persistenceConfig.length > 0) {\r\n    references.internals.persistenceConfig.forEach(persistInstance => {\r\n      const { path, config } = persistInstance;\r\n      const { blacklist, mergeStrategy, storage, whitelist } = config;\r\n\r\n      const state = references.internals.defaultState;\r\n      const persistRoot = deepCloneStateWithoutComputed(get(path, state));\r\n      const targets = resolvePersistTargets(persistRoot, whitelist, blacklist);\r\n\r\n      const applyRehydrationStrategy = (originalState, rehydratedState) => {\r\n        if (mergeStrategy === 'overwrite') {\r\n          set(path, originalState, rehydratedState);\r\n        } else if (mergeStrategy === 'merge') {\r\n          const target = get(path, originalState);\r\n          Object.keys(rehydratedState).forEach(key => {\r\n            target[key] = rehydratedState[key];\r\n          });\r\n        } else if (mergeStrategy === 'mergeDeep') {\r\n          const target = get(path, originalState);\r\n          const setAt = (currentTarget, currentNext) => {\r\n            Object.keys(currentNext).forEach(key => {\r\n              const data = currentNext[key];\r\n              if (isPlainObject(data)) {\r\n                if (!isPlainObject(currentTarget[key])) {\r\n                  currentTarget[key] = {};\r\n                }\r\n                setAt(currentTarget[key], data);\r\n              } else {\r\n                currentTarget[key] = data;\r\n              }\r\n            });\r\n          };\r\n          setAt(target, rehydratedState);\r\n        }\r\n      };\r\n\r\n      if (storage.isAsync) {\r\n        const asyncStateResolvers = targets.reduce((acc, key) => {\r\n          const targetPath = [...path, key];\r\n          const dataPromise = storage.getItem(persistKey(targetPath));\r\n          if (isPromise(dataPromise)) {\r\n            acc.push({\r\n              key,\r\n              dataPromise,\r\n            });\r\n          }\r\n          return acc;\r\n        }, []);\r\n        if (asyncStateResolvers.length > 0) {\r\n          resolveRehydration = Promise.all(\r\n            asyncStateResolvers.map(x => x.dataPromise),\r\n          ).then(resolvedData => {\r\n            const next = resolvedData.reduce((acc, cur, idx) => {\r\n              const { key } = asyncStateResolvers[idx];\r\n              if (cur !== undefined) {\r\n                acc[key] = cur;\r\n              }\r\n              return acc;\r\n            }, {});\r\n            if (Object.keys(next).length === 0) {\r\n              return;\r\n            }\r\n            applyRehydrationStrategy(state, next);\r\n            replaceState(state);\r\n          });\r\n        }\r\n      } else {\r\n        const next = targets.reduce((acc, key) => {\r\n          const targetPath = [...path, key];\r\n          const data = storage.getItem(persistKey(targetPath));\r\n          if (data !== undefined) {\r\n            acc[key] = data;\r\n          }\r\n          return acc;\r\n        }, {});\r\n        applyRehydrationStrategy(state, next);\r\n        replaceState(state);\r\n      }\r\n    });\r\n  }\r\n  return resolveRehydration;\r\n}\r\n","import { actionSymbol, actionOnSymbol } from './constants';\r\n\r\nexport function createActionCreator(actionDefinition, meta, references) {\r\n  const prefix = actionDefinition[actionSymbol] ? '@action' : '@actionOn';\r\n  const type = `${prefix}.${meta.path.join('.')}`;\r\n  const actionMeta =\r\n    actionDefinition[actionSymbol] || actionDefinition[actionOnSymbol];\r\n  actionMeta.actionName = meta.key;\r\n  actionMeta.type = type;\r\n  actionMeta.parent = meta.parent;\r\n  actionMeta.path = meta.path;\r\n\r\n  const actionCreator = payload => {\r\n    const action = {\r\n      type,\r\n      payload,\r\n    };\r\n    if (actionDefinition[actionOnSymbol] && actionMeta.resolvedTargets) {\r\n      payload.resolvedTargets = [...actionMeta.resolvedTargets];\r\n    }\r\n    const result = references.dispatch(action);\r\n    return result;\r\n  };\r\n  actionCreator.type = type;\r\n\r\n  return actionCreator;\r\n}\r\n","import { thunkSymbol, thunkOnSymbol } from './constants';\r\nimport { get, isPromise } from './lib';\r\n\r\nexport function createThunkHandler(\r\n  thunkDefinition,\r\n  meta,\r\n  references,\r\n  injections,\r\n  actionCreators,\r\n) {\r\n  const thunkMeta =\r\n    thunkDefinition[thunkSymbol] || thunkDefinition[thunkOnSymbol];\r\n\r\n  return payload => {\r\n    const helpers = {\r\n      dispatch: references.dispatch,\r\n      getState: () => get(meta.parent, references.getState()),\r\n      getStoreActions: () => actionCreators,\r\n      getStoreState: references.getState,\r\n      injections,\r\n      meta,\r\n    };\r\n    if (thunkDefinition[thunkOnSymbol] && thunkMeta.resolvedTargets) {\r\n      payload.resolvedTargets = [...thunkMeta.resolvedTargets];\r\n    }\r\n    return thunkDefinition(get(meta.parent, actionCreators), payload, helpers);\r\n  };\r\n}\r\n\r\nexport function createThunkActionsCreator(\r\n  thunkDefinition,\r\n  meta,\r\n  references,\r\n  thunkHandler,\r\n) {\r\n  const prefix = thunkDefinition[thunkSymbol] ? '@thunk' : '@thunkOn';\r\n  const type = `${prefix}.${meta.path.join('.')}`;\r\n  const startType = `${type}(start)`;\r\n  const successType = `${type}(success)`;\r\n  const failType = `${type}(fail)`;\r\n\r\n  const thunkMeta =\r\n    thunkDefinition[thunkSymbol] || thunkDefinition[thunkOnSymbol];\r\n  thunkMeta.type = type;\r\n  thunkMeta.actionName = meta.key;\r\n  thunkMeta.parent = meta.parent;\r\n  thunkMeta.path = meta.path;\r\n\r\n  const actionCreator = payload => {\r\n    const dispatchError = err => {\r\n      references.dispatch({\r\n        type: failType,\r\n        payload,\r\n        error: err,\r\n      });\r\n      references.dispatch({\r\n        type,\r\n        payload,\r\n        error: err,\r\n      });\r\n    };\r\n    const dispatchSuccess = result => {\r\n      references.dispatch({\r\n        type: successType,\r\n        payload,\r\n        result,\r\n      });\r\n      references.dispatch({\r\n        type,\r\n        payload,\r\n        result,\r\n      });\r\n    };\r\n\r\n    references.dispatch({\r\n      type: startType,\r\n      payload,\r\n    });\r\n    try {\r\n      const result = references.dispatch(() => thunkHandler(payload));\r\n      if (isPromise(result)) {\r\n        return result\r\n          .then(resolved => {\r\n            dispatchSuccess(resolved);\r\n            return resolved;\r\n          })\r\n          .catch(err => {\r\n            dispatchError(err);\r\n            throw err;\r\n          });\r\n      }\r\n      dispatchSuccess(result);\r\n      return result;\r\n    } catch (err) {\r\n      dispatchError(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  actionCreator.type = type;\r\n  actionCreator.startType = startType;\r\n  actionCreator.successType = successType;\r\n  actionCreator.failType = failType;\r\n\r\n  return actionCreator;\r\n}\r\n","import { actionOnSymbol, thunkOnSymbol } from './constants';\r\nimport { get } from './lib';\r\n\r\nexport function createListenerMiddleware(references) {\r\n  return () => next => action => {\r\n    const result = next(action);\r\n    if (\r\n      action &&\r\n      references.internals.listenerActionMap[action.type] &&\r\n      references.internals.listenerActionMap[action.type].length > 0\r\n    ) {\r\n      const sourceAction = references.internals.actionCreatorDict[action.type];\r\n      references.internals.listenerActionMap[action.type].forEach(\r\n        actionCreator => {\r\n          actionCreator({\r\n            type: sourceAction ? sourceAction.type : action.type,\r\n            payload: action.payload,\r\n            error: action.error,\r\n            result: action.result,\r\n          });\r\n        },\r\n      );\r\n    }\r\n    return result;\r\n  };\r\n}\r\n\r\nexport function bindListenerDefinitions(\r\n  listenerDefinitions,\r\n  actionCreators,\r\n  actionCreatorDict,\r\n  listenerActionMap,\r\n) {\r\n  listenerDefinitions.forEach(listenerActionOrThunk => {\r\n    const listenerMeta =\r\n      listenerActionOrThunk[actionOnSymbol] ||\r\n      listenerActionOrThunk[thunkOnSymbol];\r\n\r\n    const targets = listenerMeta.targetResolver(\r\n      get(listenerMeta.parent, actionCreators),\r\n      actionCreators,\r\n    );\r\n    const targetTypes = (Array.isArray(targets) ? targets : [targets]).reduce(\r\n      (acc, target) => {\r\n        if (\r\n          typeof target === 'function' &&\r\n          target.type &&\r\n          actionCreatorDict[target.type]\r\n        ) {\r\n          acc.push(target.type);\r\n        } else if (typeof target === 'string') {\r\n          acc.push(target);\r\n        }\r\n        return acc;\r\n      },\r\n      [],\r\n    );\r\n\r\n    listenerMeta.resolvedTargets = targetTypes;\r\n\r\n    targetTypes.forEach(targetType => {\r\n      const listenerReg = listenerActionMap[targetType] || [];\r\n      listenerReg.push(actionCreatorDict[listenerMeta.type]);\r\n      listenerActionMap[targetType] = listenerReg;\r\n    });\r\n  });\r\n}\r\n","import memoizerific from 'memoizerific';\r\nimport { get } from './lib';\r\nimport { computedSymbol } from './constants';\r\n\r\nexport function createComputedPropertyBinder(\r\n  parentPath,\r\n  key,\r\n  definition,\r\n  computedState,\r\n  references,\r\n) {\r\n  const computedMeta = definition[computedSymbol];\r\n  const memoisedResultFn = memoizerific(1)(definition);\r\n  return function createComputedProperty(o) {\r\n    Object.defineProperty(o, key, {\r\n      configurable: true,\r\n      enumerable: true,\r\n      get: () => {\r\n        let storeState;\r\n        if (computedState.isInReducer) {\r\n          storeState = computedState.currentState;\r\n        } else if (references.getState == null) {\r\n          return undefined;\r\n        } else {\r\n          try {\r\n            storeState = references.getState();\r\n          } catch (err) {\r\n            if (process.env.NODE_ENV === 'development') {\r\n              console.warn('Invalid access attempt to a computed property');\r\n            }\r\n            return undefined;\r\n          }\r\n        }\r\n        const state = get(parentPath, storeState);\r\n        const inputs = computedMeta.stateResolvers.map(resolver =>\r\n          resolver(state, storeState),\r\n        );\r\n        return memoisedResultFn(...inputs);\r\n      },\r\n    });\r\n  };\r\n}\r\n\r\nexport function createComputedPropertiesMiddleware(references) {\r\n  return store => next => action => {\r\n    references.internals.computedState.currentState = store.getState();\r\n    references.internals.computedState.isInReducer = true;\r\n    return next(action);\r\n  };\r\n}\r\n","import isPlainObject from 'is-plain-object';\r\nimport {\r\n  actionOnSymbol,\r\n  actionSymbol,\r\n  computedSymbol,\r\n  persistSymbol,\r\n  reducerSymbol,\r\n  thunkOnSymbol,\r\n  thunkSymbol,\r\n} from './constants';\r\nimport { get, set } from './lib';\r\nimport { extractPersistConfig } from './persistence';\r\nimport { createActionCreator } from './actions';\r\nimport { createThunkHandler, createThunkActionsCreator } from './thunks';\r\nimport { bindListenerDefinitions } from './listeners';\r\nimport { createComputedPropertyBinder } from './computed-properties';\r\n\r\nexport default function extractDataFromModel(\r\n  model,\r\n  initialState,\r\n  injections,\r\n  references,\r\n) {\r\n  const defaultState = initialState;\r\n  const actionCreatorDict = {};\r\n  const actionCreators = {};\r\n  const actionReducersDict = {};\r\n  const actionThunks = {};\r\n  const computedProperties = [];\r\n  const customReducers = [];\r\n  const listenerActionCreators = {};\r\n  const listenerActionMap = {};\r\n  const listenerDefinitions = [];\r\n  const persistenceConfig = [];\r\n  const computedState = {\r\n    isInReducer: false,\r\n    currentState: defaultState,\r\n  };\r\n\r\n  const recursiveExtractFromModel = (current, parentPath) =>\r\n    Object.keys(current).forEach(key => {\r\n      const value = current[key];\r\n      const path = [...parentPath, key];\r\n      const meta = {\r\n        parent: parentPath,\r\n        path,\r\n        key,\r\n      };\r\n      const handleValueAsState = () => {\r\n        const initialParentRef = get(parentPath, initialState);\r\n        if (initialParentRef && key in initialParentRef) {\r\n          set(path, defaultState, initialParentRef[key]);\r\n        } else {\r\n          set(path, defaultState, value);\r\n        }\r\n      };\r\n\r\n      if (key === persistSymbol) {\r\n        persistenceConfig.push(extractPersistConfig(parentPath, value));\r\n        return;\r\n      }\r\n\r\n      if (typeof value === 'function') {\r\n        if (value[actionSymbol] || value[actionOnSymbol]) {\r\n          const actionReducer = value;\r\n          const actionCreator = createActionCreator(value, meta, references);\r\n          actionCreatorDict[actionCreator.type] = actionCreator;\r\n          actionReducersDict[actionCreator.type] = actionReducer;\r\n          if (meta.key !== 'ePRS') {\r\n            if (value[actionOnSymbol]) {\r\n              listenerDefinitions.push(value);\r\n              set(path, listenerActionCreators, actionCreator);\r\n            } else {\r\n              set(path, actionCreators, actionCreator);\r\n            }\r\n          }\r\n        } else if (value[thunkSymbol] || value[thunkOnSymbol]) {\r\n          const thunkHandler = createThunkHandler(\r\n            value,\r\n            meta,\r\n            references,\r\n            injections,\r\n            actionCreators,\r\n          );\r\n          const actionCreator = createThunkActionsCreator(\r\n            value,\r\n            meta,\r\n            references,\r\n            thunkHandler,\r\n          );\r\n          set(path, actionThunks, thunkHandler);\r\n          actionCreatorDict[actionCreator.type] = actionCreator;\r\n          if (value[thunkOnSymbol]) {\r\n            listenerDefinitions.push(value);\r\n            set(path, listenerActionCreators, actionCreator);\r\n          } else {\r\n            set(path, actionCreators, actionCreator);\r\n          }\r\n        } else if (value[computedSymbol]) {\r\n          const parent = get(parentPath, defaultState);\r\n          const bindComputedProperty = createComputedPropertyBinder(\r\n            parentPath,\r\n            key,\r\n            value,\r\n            computedState,\r\n            references,\r\n          );\r\n          bindComputedProperty(parent);\r\n          computedProperties.push({ key, parentPath, bindComputedProperty });\r\n        } else if (value[reducerSymbol]) {\r\n          customReducers.push({ key, parentPath, reducer: value });\r\n        } else {\r\n          handleValueAsState();\r\n        }\r\n      } else if (isPlainObject(value)) {\r\n        const existing = get(path, defaultState);\r\n        if (existing == null) {\r\n          set(path, defaultState, {});\r\n        }\r\n        recursiveExtractFromModel(value, path);\r\n      } else {\r\n        handleValueAsState();\r\n      }\r\n    });\r\n\r\n  recursiveExtractFromModel(model, []);\r\n\r\n  bindListenerDefinitions(\r\n    listenerDefinitions,\r\n    actionCreators,\r\n    actionCreatorDict,\r\n    listenerActionMap,\r\n  );\r\n\r\n  return {\r\n    actionCreatorDict,\r\n    actionCreators,\r\n    actionReducersDict,\r\n    computedProperties,\r\n    customReducers,\r\n    computedState,\r\n    defaultState,\r\n    listenerActionCreators,\r\n    listenerActionMap,\r\n    persistenceConfig,\r\n  };\r\n}\r\n","import createReducer from './create-reducer';\r\nimport extractDataFromModel from './extract-data-from-model';\r\n\r\nexport default function createStoreInternals({\r\n  disableImmer,\r\n  initialState,\r\n  injections,\r\n  model,\r\n  reducerEnhancer,\r\n  references,\r\n}) {\r\n  const {\r\n    actionCreatorDict,\r\n    actionCreators,\r\n    actionReducersDict,\r\n    computedState,\r\n    computedProperties,\r\n    customReducers,\r\n    defaultState,\r\n    listenerActionCreators,\r\n    listenerActionMap,\r\n    persistenceConfig,\r\n  } = extractDataFromModel(model, initialState, injections, references);\r\n\r\n  const rootReducer = createReducer(\r\n    disableImmer,\r\n    actionReducersDict,\r\n    customReducers,\r\n    computedProperties,\r\n  );\r\n\r\n  return {\r\n    actionCreatorDict,\r\n    actionCreators,\r\n    computedProperties,\r\n    computedState,\r\n    defaultState,\r\n    listenerActionCreators,\r\n    listenerActionMap,\r\n    persistenceConfig,\r\n    reducer: reducerEnhancer(rootReducer),\r\n  };\r\n}\r\n","import {\r\n  applyMiddleware,\r\n  compose as reduxCompose,\r\n  createStore as reduxCreateStore,\r\n} from 'redux';\r\nimport reduxThunk from 'redux-thunk';\r\nimport * as helpers from './helpers';\r\nimport createStoreInternals from './create-store-internals';\r\nimport {\r\n  createPersistor,\r\n  createPersistMiddleware,\r\n  createPersistenceClearer,\r\n  rehydrateStateFromPersistIfNeeded,\r\n} from './persistence';\r\nimport { createComputedPropertiesMiddleware } from './computed-properties';\r\nimport { createListenerMiddleware } from './listeners';\r\nimport { deepCloneStateWithoutComputed } from './lib';\r\n\r\nexport default function createStore(model, options = {}) {\r\n  const modelClone = deepCloneStateWithoutComputed(model);\r\n  const {\r\n    compose,\r\n    devTools = true,\r\n    disableImmer = false,\r\n    enhancers = [],\r\n    initialState = {},\r\n    injections,\r\n    middleware = [],\r\n    mockActions = false,\r\n    name: storeName = `EasyPeasyStore`,\r\n    reducerEnhancer = rootReducer => rootReducer,\r\n  } = options;\r\n\r\n  const bindReplaceState = modelDef => {\r\n    return {\r\n      ...modelDef,\r\n      ePRS: helpers.action((_, payload) => payload),\r\n    };\r\n  };\r\n\r\n  const references = {};\r\n\r\n  let modelDefinition = bindReplaceState(modelClone);\r\n  let mockedActions = [];\r\n\r\n  const persistKey = targetPath => `[${storeName}]@${targetPath.join('.')}`;\r\n  const persistor = createPersistor(persistKey, references);\r\n  const persistMiddleware = createPersistMiddleware(persistor, references);\r\n  const clearPersistance = createPersistenceClearer(persistKey, references);\r\n\r\n  const replaceState = nextState =>\r\n    references.internals.actionCreatorDict['@action.ePRS'](nextState);\r\n\r\n  const bindStoreInternals = (state = {}) => {\r\n    references.internals = createStoreInternals({\r\n      disableImmer,\r\n      initialState: state,\r\n      injections,\r\n      model: modelDefinition,\r\n      reducerEnhancer,\r\n      references,\r\n    });\r\n  };\r\n\r\n  const mockActionsMiddleware = () => () => action => {\r\n    if (action != null) {\r\n      mockedActions.push(action);\r\n    }\r\n    return undefined;\r\n  };\r\n\r\n  const composeEnhancers =\r\n    compose ||\r\n    (devTools &&\r\n    typeof window !== 'undefined' &&\r\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\r\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\r\n          name: storeName,\r\n        })\r\n      : reduxCompose);\r\n\r\n  bindStoreInternals(initialState);\r\n\r\n  const easyPeasyMiddleware = [\r\n    createComputedPropertiesMiddleware(references),\r\n    reduxThunk,\r\n    ...middleware,\r\n    createListenerMiddleware(references),\r\n    persistMiddleware,\r\n  ];\r\n\r\n  if (mockActions) {\r\n    easyPeasyMiddleware.push(mockActionsMiddleware);\r\n  }\r\n\r\n  const store = reduxCreateStore(\r\n    references.internals.reducer,\r\n    references.internals.defaultState,\r\n    composeEnhancers(applyMiddleware(...easyPeasyMiddleware), ...enhancers),\r\n  );\r\n\r\n  store.subscribe(() => {\r\n    references.internals.computedState.isInReducer = false;\r\n  });\r\n\r\n  references.dispatch = store.dispatch;\r\n  references.getState = store.getState;\r\n\r\n  const bindActionCreators = () => {\r\n    Object.keys(store.dispatch).forEach(actionsKey => {\r\n      delete store.dispatch[actionsKey];\r\n    });\r\n    Object.keys(references.internals.actionCreators).forEach(key => {\r\n      store.dispatch[key] = references.internals.actionCreators[key];\r\n    });\r\n  };\r\n\r\n  bindActionCreators();\r\n\r\n  const rebindStore = removeKey => {\r\n    const currentState = store.getState();\r\n    if (removeKey) {\r\n      delete currentState[removeKey];\r\n    }\r\n    bindStoreInternals(currentState);\r\n    store.replaceReducer(references.internals.reducer);\r\n    replaceState(references.internals.defaultState);\r\n    bindActionCreators();\r\n  };\r\n\r\n  const resolveRehydration = rehydrateStateFromPersistIfNeeded(\r\n    persistKey,\r\n    replaceState,\r\n    references,\r\n  );\r\n\r\n  return Object.assign(store, {\r\n    addModel: (key, modelForKey) => {\r\n      if (modelDefinition[key] && process.env.NODE_ENV !== 'production') {\r\n        // eslint-disable-next-line no-console\r\n        console.warn(\r\n          `easy-peasy: The store model already contains a model definition for \"${key}\"`,\r\n        );\r\n        store.removeModel(key);\r\n      }\r\n      modelDefinition[key] = modelForKey;\r\n      rebindStore();\r\n    },\r\n    clearMockedActions: () => {\r\n      mockedActions = [];\r\n    },\r\n    getActions: () => references.internals.actionCreators,\r\n    getListeners: () => references.internals.listenerActionCreators,\r\n    getMockedActions: () => [...mockedActions],\r\n    persist: {\r\n      clear: clearPersistance,\r\n      flush: () => persistor.flush(),\r\n      resolveRehydration: () => resolveRehydration,\r\n    },\r\n    reconfigure: newModel => {\r\n      modelDefinition = bindReplaceState(newModel);\r\n      rebindStore();\r\n    },\r\n    removeModel: key => {\r\n      if (!modelDefinition[key]) {\r\n        if (process.env.NODE_ENV !== 'production') {\r\n          // eslint-disable-next-line no-console\r\n          console.warn(\r\n            `easy-peasy: The store model does not contain a model definition for \"${key}\"`,\r\n          );\r\n        }\r\n        return;\r\n      }\r\n      delete modelDefinition[key];\r\n      rebindStore(key);\r\n    },\r\n  });\r\n}\r\n","/* eslint-disable react/prop-types */\r\n\r\nimport React, { createContext, useContext, useMemo } from 'react';\r\nimport {\r\n  createStoreActionsHook,\r\n  createStoreDispatchHook,\r\n  createStoreStateHook,\r\n  createStoreRehydratedHook,\r\n} from './hooks';\r\nimport createStore from './create-store';\r\n\r\nexport default function createContextStore(model, config) {\r\n  const StoreContext = createContext();\r\n\r\n  function Provider({ children, initialData }) {\r\n    const store = useMemo(\r\n      () =>\r\n        createStore(\r\n          typeof model === 'function' ? model(initialData) : model,\r\n          config,\r\n        ),\r\n      [],\r\n    );\r\n    return (\r\n      <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\r\n    );\r\n  }\r\n\r\n  function useStore() {\r\n    return useContext(StoreContext);\r\n  }\r\n\r\n  return {\r\n    Provider,\r\n    useStore,\r\n    useStoreState: createStoreStateHook(StoreContext),\r\n    useStoreActions: createStoreActionsHook(StoreContext),\r\n    useStoreDispatch: createStoreDispatchHook(StoreContext),\r\n    useStoreRehydrated: createStoreRehydratedHook(StoreContext),\r\n  };\r\n}\r\n","import { useMemo, useState, useRef, useEffect } from 'react';\r\nimport createStore from './create-store';\r\n\r\n/**\r\n * Some good references on the topic of reinitialisation:\r\n * - https://github.com/facebook/react/issues/14830\r\n */\r\n\r\nexport default function createComponentStore(model, config) {\r\n  return function useLocalStore(initialData) {\r\n    const store = useMemo(\r\n      () =>\r\n        createStore(\r\n          typeof model === 'function' ? model(initialData) : model,\r\n          config,\r\n        ),\r\n      [],\r\n    );\r\n    const previousStateRef = useRef(store.getState());\r\n    const [currentState, setCurrentState] = useState(() => store.getState());\r\n    useEffect(() => {\r\n      return store.subscribe(() => {\r\n        const nextState = store.getState();\r\n        if (previousStateRef.current !== nextState) {\r\n          previousStateRef.current = nextState;\r\n          setCurrentState(nextState);\r\n        }\r\n      });\r\n    }, [store]);\r\n    return [currentState, store.getActions()];\r\n  };\r\n}\r\n","/**\r\n * This file has been copied from redux-persist.\r\n * The intention being to support as much of the redux-persist API as possible.\r\n */\r\n\r\nexport default function createTransform(inbound, outbound, config = {}) {\r\n  const whitelist = config.whitelist || null;\r\n  const blacklist = config.blacklist || null;\r\n\r\n  function whitelistBlacklistCheck(key) {\r\n    if (whitelist && whitelist.indexOf(key) === -1) return true;\r\n    if (blacklist && blacklist.indexOf(key) !== -1) return true;\r\n    return false;\r\n  }\r\n\r\n  return {\r\n    in: (data, key, fullState) =>\r\n      !whitelistBlacklistCheck(key) && inbound\r\n        ? inbound(data, key, fullState)\r\n        : data,\r\n    out: (data, key, fullState) =>\r\n      !whitelistBlacklistCheck(key) && outbound\r\n        ? outbound(data, key, fullState)\r\n        : data,\r\n  };\r\n}\r\n","import React from 'react';\r\nimport StoreContext from './context';\r\n\r\nexport default function StoreProvider({ children, store }) {\r\n  return (\r\n    <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\r\n  );\r\n}\r\n","import { setAutoFreeze } from 'immer-peasy';\r\nimport {\r\n  createTypedHooks,\r\n  useStoreActions,\r\n  useStoreDispatch,\r\n  useStoreState,\r\n  useStoreRehydrated,\r\n  useStore,\r\n} from './hooks';\r\nimport createStore from './create-store';\r\nimport createContextStore from './create-context-store';\r\nimport createComponentStore from './create-component-store';\r\nimport createTransform from './create-transform';\r\nimport StoreProvider from './provider';\r\nimport {\r\n  action,\r\n  actionOn,\r\n  computed,\r\n  debug,\r\n  memo,\r\n  persist,\r\n  reducer,\r\n  thunk,\r\n  thunkOn,\r\n} from './helpers';\r\n\r\n/**\r\n * The auto freeze feature of immer doesn't seem to work in our testing. We have\r\n * explicitly disabled it to avoid perf issues.\r\n */\r\nsetAutoFreeze(false);\r\n\r\nexport {\r\n  action,\r\n  actionOn,\r\n  computed,\r\n  createComponentStore,\r\n  createContextStore,\r\n  createStore,\r\n  createTransform,\r\n  createTypedHooks,\r\n  debug,\r\n  memo,\r\n  persist,\r\n  reducer,\r\n  StoreProvider,\r\n  thunk,\r\n  thunkOn,\r\n  useStoreActions,\r\n  useStoreDispatch,\r\n  useStoreState,\r\n  useStoreRehydrated,\r\n  useStore,\r\n};\r\n"],"names":["StoreContext","createContext","useIsomorphicLayoutEffect","window","useLayoutEffect","useEffect","createStoreStateHook","Context","useStoreState","mapState","store","useContext","mapStateRef","useRef","stateRef","mountedRef","subscriptionMapStateError","useReducer","s","forceRender","current","undefined","getState","err","process","env","NODE_ENV","errorMessage","message","stack","Error","checkMapState","newState","unsubscribe","subscribe","EasyPeasyContext","createStoreActionsHook","useStoreActions","mapActions","getActions","createStoreDispatchHook","useStoreDispatch","dispatch","useStore","createStoreRehydratedHook","useStoreRehydrated","useState","rehydrated","setRehydrated","persist","resolveRehydration","then","createTypedHooks","actionSymbol","actionOnSymbol","computedSymbol","persistSymbol","reducerSymbol","thunkOnSymbol","thunkSymbol","debug","state","isDraft","original","memo","fn","cacheSize","memoizerific","actionOn","targetResolver","action","defaultStateResolvers","computed","fnOrStateResolvers","stateResolvers","model","config","thunkOn","thunk","reducer","deepCloneStateWithoutComputed","source","recursiveClone","next","Object","keys","reduce","acc","key","getOwnPropertyDescriptor","get","forEach","isPlainObject","isPromise","x","path","target","cur","newify","currentPath","currentState","finalValue","length","slice","set","value","idx","createSimpleProduce","disableImmer","simpleProduce","draft","createDraft","result","finishDraft","parentPath","parent","createReducer","actionReducersDict","customReducers","computedProperties","runActionReducerAtPath","actionReducer","payload","reducerForActions","type","actionMeta","reducerForCustomReducers","red","rootReducer","stateAfterActions","bindComputedProperty","noopStorage","getItem","setItem","removeItem","localStorage","sessionStorage","createStorageWrapper","storage","transformers","console","warn","outTransformers","reverse","serialize","data","simpleKey","substr","indexOf","transformed","in","JSON","stringify","deserialize","parse","out","isAsync","wrapped","extractPersistConfig","persistDefinition","blacklist","mergeStrategy","whitelist","resolvePersistTargets","targets","findIndex","createPersistor","persistKey","references","debounce","internals","persistenceConfig","persistRoot","targetPath","createPersistMiddleware","persistor","createPersistenceClearer","Promise","resolve","reject","all","map","rehydrateStateFromPersistIfNeeded","replaceState","persistInstance","defaultState","applyRehydrationStrategy","originalState","rehydratedState","setAt","currentTarget","currentNext","asyncStateResolvers","dataPromise","push","resolvedData","createActionCreator","actionDefinition","meta","prefix","join","actionName","actionCreator","resolvedTargets","createThunkHandler","thunkDefinition","injections","actionCreators","thunkMeta","helpers","getStoreActions","getStoreState","createThunkActionsCreator","thunkHandler","startType","successType","failType","dispatchError","error","dispatchSuccess","resolved","catch","createListenerMiddleware","listenerActionMap","sourceAction","actionCreatorDict","bindListenerDefinitions","listenerDefinitions","listenerActionOrThunk","listenerMeta","targetTypes","Array","isArray","targetType","listenerReg","createComputedPropertyBinder","definition","computedState","computedMeta","memoisedResultFn","createComputedProperty","o","defineProperty","configurable","enumerable","storeState","isInReducer","inputs","resolver","createComputedPropertiesMiddleware","extractDataFromModel","initialState","actionThunks","listenerActionCreators","recursiveExtractFromModel","handleValueAsState","initialParentRef","existing","createStoreInternals","reducerEnhancer","createStore","options","modelClone","compose","devTools","enhancers","middleware","mockActions","name","storeName","bindReplaceState","modelDef","ePRS","_","modelDefinition","mockedActions","persistMiddleware","clearPersistance","nextState","bindStoreInternals","mockActionsMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reduxCompose","easyPeasyMiddleware","reduxThunk","reduxCreateStore","applyMiddleware","bindActionCreators","actionsKey","rebindStore","removeKey","replaceReducer","assign","addModel","modelForKey","removeModel","clearMockedActions","getListeners","getMockedActions","clear","flush","reconfigure","newModel","createContextStore","Provider","children","initialData","useMemo","createComponentStore","useLocalStore","previousStateRef","setCurrentState","createTransform","inbound","outbound","whitelistBlacklistCheck","fullState","StoreProvider","setAutoFreeze"],"mappings":"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"}